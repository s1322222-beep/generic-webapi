<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>AI Fortune Canvas</title>
<script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
<style>
body{margin:0;background:#111;color:#fff;font-family:sans-serif}
input,button{padding:10px;font-size:16px}
header{padding:10px}
</style>
</head>
<body>
<header>
<input id="msg" placeholder="ä¸€è¨€ï¼ˆä¾‹ï¼šæ‹ãƒ»ãƒã‚¤ãƒˆãƒ»ãƒ†ã‚¹ãƒˆï¼‰">
<button onclick="send()">å ã†</button>
<div id="fortune"></div>
</header>

<script>
let data = {color:"#fff",shape:"circle",luck:0.5,fortune:""};

function send(){
  const text = document.getElementById("msg").value;
  fetch("/api/",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({text})
  })
  .then(r=>r.json())
  .then(j=>{
    data=j;
    document.getElementById("fortune").innerText =
      "ğŸ”® "+j.fortune+" ("+Math.round(j.luck*100)+"%)";
  });
}

function setup(){
  createCanvas(window.innerWidth,400);
}
function draw(){
  background(10);
  fill(data.color);
  noStroke();
  const s = 100 + data.luck*200;
  if(data.shape==="square"){
    rect(width/2-s/2,height/2-s/2,s,s,20);
  }else{
    ellipse(width/2,height/2,s,s);
  }
}
</script>
</body>
</html>
